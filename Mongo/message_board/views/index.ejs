<html>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<body>
<form action="/new_message" method="post">
  <div class="form-group">
    <label for="exampleInputEmail1">Name</label>
    <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="name" placeholder="Enter name">
  </div>
  <div class="form-group">
    <label for="exampleInputPassword1">Message</label>
    <input type="text" class="form-control" id="exampleInputPassword1" name="message" placeholder="Message">
  </div>
  <button type="submit" class="btn btn-primary">Submit</button>
</form>
<div class="messages">
    <div id="comments"></div>
</div>

<% for (const i in messages) { %>
  <p>Name: <%= messages[i].name %></p>
  <p>Message: <%= messages[i].message %></p>
  <% if (messages[i].comments) { %>
    <% for(j in messages[i].comments) { %>
        <div style="margin-left: 30px;">
          <p>Name: <%= messages[i].comments[j].name %></p>
          <p>Comment: <%= messages[i].comments[j].comment %></p>
        </div>
      <% } %>
      <form style="margin-left: 30px;" action="/new_comment/<%= messages[i]._id %>" method="post" class="form-group">
            <label>Name: </label><br>
            <input type="text" name="name" class="form-control"></input>
            <label>Comment: </label><br>
            <textarea name="comment" class="form-control" rows="4"></textarea><br>
            <input type="submit" style="float: right;" value="Post Comment"></input>
          </form><br><br>
    <% } %>
  <% } %>
</body>
</html>